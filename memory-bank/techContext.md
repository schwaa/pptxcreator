# Technical Context

## Technology Stack

### Core Technologies
- Python 3.13+
- `python-pptx` library (PowerPoint manipulation)
- `openai` library (as client for OpenRouter API)
- OpenRouter API (content analysis, model: `deepseek/deepseek-chat-v3-0324:free`)
- `Pillow` library (image handling - basic, for future enhancement)
- `argparse` (CLI argument parsing in `main.py`)
- `json` (for data contracts: `layouts.json`, `presentation.json`)
- `os` (for path manipulation)
- `logging` (for application logging)
- `ast` (specifically `ast.literal_eval` for parsing stringified literals from LLM)

### Development Tools
- Virtual Environment (`venv`)
- Git (version control)
- `pytest` (testing)
- Visual Studio Code (recommended IDE)

## Project Structure
```
pptx-generator/
├── pptx_generator/
│   ├── __init__.py
│   ├── main.py           # CLI entry point (uses argparse)
│   ├── analyzer.py       # Template analysis logic
│   ├── processor.py      # Content processing logic (LLM interaction)
│   ├── generator.py      # PPTX generation logic
│   └── utils.py          # Shared utilities (if any, currently minimal)
├── projects/
│   └── <project_name>/
│       ├── content.md
│       ├── images/         # Optional: for project-specific images
│       └── output/
│           ├── layouts.json
│           ├── presentation.json
│           └── <project_name>.pptx
├── templates/              # Default location for PPTX templates
│   └── default_template.pptx
├── tests/
│   ├── __init__.py
│   ├── test_analyzer.py
│   ├── test_processor.py
│   ├── test_generator.py
│   └── fixtures/           # Test fixtures (sample templates, md files)
├── memory-bank/            # Internal knowledge base for development
├── .env                    # For API keys (e.g., OPENROUTER_API_KEY)
├── .gitignore
├── requirements.txt        # Production dependencies
├── requirements-dev.txt    # Development dependencies
├── setup.py                # Package configuration (if distributing as a package)
└── README.md
```

## Dependencies

### Production Dependencies (`requirements.txt`)
```
python-pptx>=0.6.23
openai>=1.3.0         # For OpenRouter API client
python-dotenv>=1.0.0
# Pillow might be added if image generation/manipulation becomes more direct
# requests is a transitive dependency of openai, or can be used directly
```
*(Note: `markdown` library is not directly used by the core scripts as LLM handles markdown. `click` was replaced by `argparse`. `pydantic` is not currently used but could be for schema validation.)*

### Development Dependencies (`requirements-dev.txt`)
```
pytest>=7.0.0
pytest-cov>=4.1.0
black>=23.0.0
isort>=5.12.0
# mypy>=1.0.0
# flake8>=6.1.0
```

## Core Data Files & Schemas

### 1. `layouts.json`
- **Generated by:** `analyzer.py`
- **Purpose:** Describes the analyzed template's layouts, placeholders, and stores the path to the source template.
- **Schema:**
  ```json
  {
    "source_template_path": "path/to/template.pptx",
    "layouts": [
      {
        "name": "Layout Name 1",
        "placeholders": ["PlaceholderName1", "PlaceholderName2"]
      }
      // ... more layouts
    ]
  }
  ```

### 2. `presentation.json`
- **Generated by:** `processor.py`
- **Purpose:** Structured plan for the presentation, mapping content to layouts and placeholders.
- **Schema:**
  ```json
  {
    "slides": [
      {
        "layout": "Layout Name To Use",
        "placeholders": {
          "PlaceholderName1": "Content for placeholder 1 (string or list of strings)",
          "PlaceholderName2": "Content for placeholder 2..."
        }
      }
      // ... more slides
    ]
  }
  ```
  *Key for content map is `"placeholders"`.*

## Technical Constraints
(As previously listed, largely unchanged but now validated against current implementation)
- Template: `.pptx`, named placeholders preferred.
- Content: Markdown for `content.md`, UTF-8.
- System: Python 3.13+, internet for LLM.

## Development Setup
(As previously listed, ensure `.env` has `OPENROUTER_API_KEY`)

1. Clone Repository
2. Create Virtual Environment (`python3.13 -m venv venv`, activate)
3. Install Dependencies (`pip install -r requirements.txt -r requirements-dev.txt`)
4. Configure Environment (`.env` with `OPENROUTER_API_KEY`)
5. Run Tests (`pytest`)

## Error Handling
- `try-except` blocks for I/O, API calls.
- `ast.literal_eval` for safe parsing of LLM string output.
- Logging for warnings/errors.
- Fallback parser in `processor.py`.
