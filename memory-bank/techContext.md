# Technical Context

## Technology Stack

### Core Technologies
- Python 3.13+
- python-pptx library (PowerPoint manipulation)
- OpenRouter API (content analysis, using model deepseek/deepseek-chat-v3-0324:free)
- Pillow library (image handling)
- Click library (CLI interface)

### Development Tools
- Virtual Environment (venv)
- Git (version control)
- pytest (testing)
- Visual Studio Code (recommended IDE)

## Project Structure
```
pptx-generator/
├── pptx_generator/
│   ├── __init__.py
│   ├── main.py           # CLI entry point
│   ├── analyzer.py       # Template analysis
│   ├── processor.py      # Content processing
│   ├── generator.py      # PPTX generation
│   ├── utils.py         # Shared utilities
│   └── config.py        # Configuration
├── tests/
│   ├── __init__.py
│   ├── test_analyzer.py
│   ├── test_processor.py
│   ├── test_generator.py
│   └── test_utils.py
├── examples/
│   ├── templates/       # Example templates
│   ├── markdown/       # Example content
│   └── output/        # Generated files
├── docs/
│   ├── cli.md         # CLI documentation
│   ├── templates.md   # Template guide
│   └── api.md        # API reference
├── layouts.json      # Template analysis output
├── requirements.txt  # Production dependencies
├── requirements-dev.txt  # Development dependencies
├── setup.py         # Package configuration
├── README.md        # Project documentation
└── LICENSE         # License information
```

## Dependencies

### Production Dependencies
```
python-pptx>=0.6.21    # PowerPoint file manipulation
# openai>=1.0.0        # OpenAI API client (Potentially still used if OpenRouter is OpenAI-compatible, or requests library for direct API calls)
# User specified OpenRouter with model deepseek/deepseek-chat-v3-0324:free
# Assuming requests library will be used for OpenRouter if a dedicated client isn't specified.
# The 'requests' library is already listed.
markdown>=3.4.0        # Markdown parsing
Pillow>=10.0.0        # Image processing
click>=8.1.0          # CLI framework
pydantic>=2.0.0       # Data validation
python-dotenv>=1.0.0  # Environment configuration
requests>=2.31.0      # HTTP client
```

### Development Dependencies
```
pytest>=7.0.0         # Testing framework
pytest-cov>=4.1.0     # Test coverage
black>=23.0.0         # Code formatting
isort>=5.12.0        # Import sorting
mypy>=1.0.0          # Type checking
flake8>=6.1.0        # Linting
```

## Core Data Files

### 1. layouts.json
- Generated by: analyzer.py
- Purpose: Template layout mapping
- Schema:
```python
class Placeholder(BaseModel):
    name: str
    type: str

class Layout(BaseModel):
    name: str
    placeholders: List[Placeholder]

class LayoutMap(BaseModel):
    layouts: List[Layout]
```

### 2. presentation.json
- Generated by: processor.py
- Purpose: Structured presentation content
- Schema:
```python
class SlideContent(BaseModel):
    layout: str
    content: Dict[str, str]

class Presentation(BaseModel):
    slides: List[SlideContent]
```

## Technical Constraints

### Template Requirements
- Format: .pptx only (no .ppt)
- Named placeholders preferred
- Master slides recommended
- Unicode support required
- Maximum size: 100MB

### Content Requirements
- Valid markdown syntax
- UTF-8 encoding
- Maximum file size: 10MB
- Supported image formats:
  - PNG
  - JPEG
  - GIF (static only)

### System Requirements
- Python 3.13+
- 4GB RAM minimum
- 1GB free disk space
- Internet connection for LLM
- Write permissions in output directory

## Development Setup

1. Clone Repository:
   ```bash
   git clone <repository-url>
   cd pptx-generator
   ```

2. Create Virtual Environment:
   ```bash
   python3.13 -m venv venv
   source venv/bin/activate  # Unix/macOS
   venv\Scripts\activate     # Windows
   ```

3. Install Dependencies:
   ```bash
   pip install -r requirements.txt
   pip install -r requirements-dev.txt  # for development
   ```

4. Configure Environment:
   ```bash
   cp .env.example .env
   # Edit .env with your OpenRouter API key
   ```

5. Run Tests:
   ```bash
   pytest
   ```

## Error Handling

### Validation Strategy
1. Input Validation
   - Template format
   - Markdown syntax
   - File permissions
   - Resource availability

2. Process Validation
   - LLM responses (from OpenRouter)
   - Layout compatibility
   - Content mapping
   - Resource usage

3. Output Validation
   - File integrity
   - Content placement
   - Resource cleanup
   - Error reporting

### Error Categories
1. Fatal Errors (Exit)
   - Invalid template
   - Missing permissions
   - Corrupt files
   - API authentication

2. Recoverable Errors (Fallback)
   - LLM timeout
   - Layout mismatch
   - Resource limits
   - Network issues

## Testing Strategy

### Test Categories
1. Unit Tests
   - Component functions
   - Utility methods
   - Data validation
   - Error handlers

2. Integration Tests
   - Component interactions
   - File operations
   - API integration
   - End-to-end flows

3. Performance Tests
   - Resource usage
   - Processing time
   - Memory management
   - Concurrent operations

### Test Resources
- Sample templates
- Test markdown files
- Mock LLM responses
- Expected outputs
